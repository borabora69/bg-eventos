<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BG Eventos & Hospedagem — Barra Grande PI</title>
  <meta name="description" content="Eventos e hospedagem em Barra Grande PI. Dados atualizados via Google Sheets (CSV público)." />
  <style>
    /* ===== THEME VARIABLES ===== */
    :root{
      --bg: #071025;
      --surface: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      --card-bg: rgba(255,255,255,0.02);
      --text: #eaf6fb;
      --muted: #9aa4b2;
      --accent: #06b6d4;
      --accent-2: #7c3aed;
      --gold: #e6b95a;
      --glass: rgba(255,255,255,0.03);
      --radius: 12px;
      --gap: 1rem;
      --max-width: 1100px;
      --shadow: 0 10px 30px rgba(2,6,23,0.6);
      --ff: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    :root[data-theme="light"]{
      --bg: linear-gradient(180deg,#f6f8fb,#eef2f7);
      --surface: #ffffff;
      --card-bg: #ffffff;
      --text: #071025;
      --muted: #475569;
      --accent: #0ea5a4;
      --accent-2: #6b21a8;
      --glass: rgba(2,6,23,0.03);
      --shadow: 0 8px 24px rgba(2,6,23,0.06);
    }

    /* ===== BASE ===== */
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--ff);
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:24px;
      display:flex;
      justify-content:center;
    }
    .wrap{
      width:100%;
      max-width:var(--max-width);
      margin:0 auto;
    }

    /* ===== HEADER ===== */
    header{
      display:flex;
      gap:16px;
      align-items:center;
      justify-content:space-between;
      margin-bottom:18px;
    }
    .brand{display:flex;gap:12px;align-items:center}
    .logo{
      width:64px;height:64px;border-radius:12px;
      background:linear-gradient(135deg,var(--accent),var(--accent-2));
      display:flex;align-items:center;justify-content:center;font-weight:800;color:#021025;font-size:18px;
      box-shadow:var(--shadow);
    }
    h1{margin:0;font-size:1.05rem}
    .meta{color:var(--muted);font-size:.9rem}

    /* ===== NAV / CONTROLS ===== */
    nav{display:flex;gap:8px;align-items:center}
    .tab{
      padding:8px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);
      background:transparent;color:var(--muted);cursor:pointer;font-weight:700;
    }
    .tab.active{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#021025;border:none}
    .controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap}

    .input{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    .btn{padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:var(--card-bg);color:var(--muted);cursor:pointer;font-weight:700}
    .btn.primary{background:var(--accent);color:#021025;border:none}

    /* ===== HERO ===== */
    .hero{
      display:flex;gap:16px;align-items:center;padding:18px;border-radius:14px;background:var(--surface);box-shadow:var(--shadow);
      margin-bottom:16px;
    }
    .hero-left{flex:1}
    .hero-title{margin:0;font-size:1.25rem}
    .hero-sub{color:var(--muted);margin-top:6px}

    .hero-actions{display:flex;gap:8px;align-items:center}

    /* ===== GRID / CARDS ===== */
    .status{color:var(--muted);margin-bottom:12px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:var(--gap)}
    .card{
      background:var(--card-bg);border-radius:12px;overflow:hidden;box-shadow:var(--shadow);display:flex;flex-direction:column;min-height:320px;border:1px solid rgba(255,255,255,0.03);
      transition:transform .18s ease, box-shadow .18s ease;
    }
    .card:hover{transform:translateY(-6px)}
    .media{height:160px;background:#021025;position:relative;overflow:hidden}
    .media img{width:100%;height:100%;object-fit:cover;display:block}
    .card-body{padding:12px;display:flex;flex-direction:column;gap:8px;flex:1}
    .title-row{display:flex;justify-content:space-between;align-items:flex-start;gap:8px}
    .title-row h3{margin:0;font-size:1rem}
    .desc{color:var(--muted);font-size:.95rem;line-height:1.3;min-height:48px;overflow:hidden}
    .meta-row{display:flex;justify-content:space-between;align-items:center;gap:8px;font-size:.95rem;color:var(--muted)}
    .link{display:inline-block;padding:8px 10px;border-radius:8px;text-decoration:none;color:var(--muted);background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03)}
    .link.primary{background:var(--accent);color:#021025;border:none}
    .destaque{border:2px solid var(--gold);transform:scale(1.01)}
    .badge{position:absolute;right:10px;top:10px;background:var(--gold);color:#021025;padding:6px 8px;border-radius:999px;font-weight:800}

    /* ===== SKELETON ===== */
    .skeleton{animation: pulse 1.2s infinite; background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.04), rgba(255,255,255,0.02));}
    @keyframes pulse{0%{opacity:1}50%{opacity:.6}100%{opacity:1}}

    /* ===== EMPTY / FOOTER ===== */
    .empty{padding:20px;border-radius:12px;background:rgba(255,255,255,0.02);color:var(--muted);text-align:center}
    footer{margin-top:18px;color:var(--muted);display:flex;justify-content:space-between;flex-wrap:wrap;gap:8px}

    @media(max-width:720px){
      header{flex-direction:column;align-items:flex-start}
      .hero{flex-direction:column;align-items:flex-start}
    }
  </style>
</head>
<body>
  <div class="wrap" id="app">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true">BG</div>
        <div>
          <h1 id="siteTitle">BG Eventos & Hospedagem</h1>
          <div class="meta" id="siteSubtitle">Barra Grande PI • Dados via Google Sheets (CSV)</div>
        </div>
      </div>

      <nav aria-label="Navegação principal">
        <button class="tab active" data-tab="eventos" id="tabEventos" data-i18n="events">Eventos</button>
        <button class="tab" data-tab="hospedagem" id="tabHospedagem" data-i18n="stays">Hospedagem</button>
      </nav>
    </header>

    <div class="hero" role="region" aria-label="Hero">
      <div class="hero-left">
        <h2 class="hero-title" id="heroTitle">Encontre eventos e hospedagem em Barra Grande</h2>
        <div class="hero-sub" id="heroSub">Atualizado automaticamente via planilha pública</div>
      </div>
      <div class="hero-actions">
        <button class="btn" id="themeToggle" aria-pressed="false" data-i18n="theme">Tema</button>
        <button class="btn" id="langToggle" aria-pressed="false" data-i18n="lang">PT/EN</button>
      </div>
    </div>

    <main>
      <div class="controls" role="region" aria-label="Controles">
        <label class="meta" style="margin-right:6px" data-i18n="dateRangeLabel">Buscar por datas:</label>
        <input class="input" type="date" id="dateFrom" aria-label="Data de ida">
        <input class="input" type="date" id="dateTo" aria-label="Data de volta">
        <label style="display:flex;align-items:center;gap:6px;color:var(--muted)">
          <input type="checkbox" id="praiaOnly"> <span data-i18n="beachOnly">Somente eventos na praia</span>
        </label>
        <button class="btn primary" id="searchBtn" data-i18n="search">Buscar</button>
        <button class="btn" id="refreshBtn" data-i18n="refresh">Recarregar</button>
      </div>

      <div class="status" id="status" aria-live="polite">Carregando eventos...</div>

      <!-- EVENTOS -->
      <section id="contentEventos">
        <div id="grid" class="grid" aria-live="polite">
          <!-- skeleton placeholders while loading -->
          <div class="card skeleton" style="min-height:260px"></div>
          <div class="card skeleton" style="min-height:260px"></div>
          <div class="card skeleton" style="min-height:260px"></div>
        </div>
        <div id="empty" class="empty" style="display:none" data-i18n="noEvents">Nenhum evento encontrado para os filtros selecionados.</div>
      </section>

      <!-- HOSPEDAGEM -->
      <section id="contentHospedagem" style="display:none">
        <div id="hospedagemGrid" class="grid" aria-live="polite"></div>
        <div id="emptyHosp" class="empty" style="display:none" data-i18n="noStays">Nenhuma hospedagem encontrada.</div>
      </section>
    </main>

    <footer>
      <div>Última leitura: <span id="lastUpdated">—</span></div>
      <div class="meta">Repositório: borabora69/bg-eventos • Deploy: main</div>
    </footer>
  </div>

  <script>
  /* ===== CONFIG ===== */
  const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTYagiDybnUZ6o0nrMPg9OAa5af9fX5pSgc0FW1R3w_A53ueEA-xMyp3SAjpx_rIxJgBGGfic-Q3LDv/pub?output=csv';
  const IMAGE_PATH = 'img/eventos/';
  const DEFAULT_IMAGE = IMAGE_PATH + 'padrao-bg.png';
  const CACHE_BUST = false; // true para debug
  const AUTO_REFRESH_MIN = 15;

  /* ===== I18N ===== */
  const I18N = {
    pt: {
      events: 'Eventos',
      stays: 'Hospedagem',
      theme: 'Tema',
      lang: 'PT/EN',
      dateRangeLabel: 'Buscar por datas:',
      beachOnly: 'Somente eventos na praia',
      search: 'Buscar',
      refresh: 'Recarregar',
      noEvents: 'Nenhum evento encontrado para os filtros selecionados.',
      noStays: 'Nenhuma hospedagem encontrada.',
      siteTitle: 'BG Eventos & Hospedagem',
      siteSubtitle: 'Barra Grande PI • Dados via Google Sheets (CSV)',
      heroTitle: 'Encontre eventos e hospedagem em Barra Grande',
      heroSub: 'Atualizado automaticamente via planilha pública'
    },
    en: {
      events: 'Events',
      stays: 'Stays',
      theme: 'Theme',
      lang: 'EN/PT',
      dateRangeLabel: 'Search by dates:',
      beachOnly: 'Only beach events',
      search: 'Search',
      refresh: 'Refresh',
      noEvents: 'No events found for selected filters.',
      noStays: 'No stays found.',
      siteTitle: 'BG Events & Stays',
      siteSubtitle: 'Barra Grande PI • Data from Google Sheets (CSV)',
      heroTitle: 'Find events and stays in Barra Grande',
      heroSub: 'Automatically updated from public spreadsheet'
    }
  };

  function setLang(lang){
    lang = (lang === 'en') ? 'en' : 'pt';
    localStorage.setItem('bg_lang', lang);
    document.documentElement.lang = (lang === 'en') ? 'en' : 'pt-BR';
    document.querySelectorAll('[data-i18n]').forEach(el => {
      const key = el.dataset.i18n;
      if(I18N[lang] && I18N[lang][key]) el.textContent = I18N[lang][key];
    });
    // update titles
    document.getElementById('siteTitle').textContent = I18N[lang].siteTitle;
    document.getElementById('siteSubtitle').textContent = I18N[lang].siteSubtitle;
    document.getElementById('heroTitle').textContent = I18N[lang].heroTitle;
    document.getElementById('heroSub').textContent = I18N[lang].heroSub;
  }

  /* ===== THEME ===== */
  function setTheme(theme){
    theme = (theme === 'light') ? 'light' : 'dark';
    document.documentElement.setAttribute('data-theme', theme);
    localStorage.setItem('bg_theme', theme);
    document.getElementById('themeToggle').setAttribute('aria-pressed', theme === 'light');
  }

  /* ===== UTIL ===== */
  function sanitizeSlug(id){
    if(!id) return '';
    return String(id).trim().toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').replace(/[^a-z0-9\-]+/g,'-').replace(/^\-+|\-+$/g,'');
  }

  function parseCSV(text){
    const rows = [];
    let cur = '', inQuotes = false, row = [];
    for(let i=0;i<text.length;i++){
      const ch = text[i], nxt = text[i+1];
      if(ch === '"'){
        if(inQuotes && nxt === '"'){ cur += '"'; i++; continue; }
        inQuotes = !inQuotes; continue;
      }
      if(ch === ',' && !inQuotes){ row.push(cur); cur=''; continue; }
      if((ch === '\n' || ch === '\r') && !inQuotes){
        if(cur !== '' || row.length>0){ row.push(cur); rows.push(row); row=[]; cur=''; }
        if(ch === '\r' && nxt === '\n'){ i++; }
        continue;
      }
      cur += ch;
    }
    if(cur !== '' || row.length>0){ row.push(cur); rows.push(row); }
    return rows;
  }

  function parseDateFlexible(v){
    if(!v) return null;
    v = String(v).trim();
    const iso = new Date(v);
    if(!isNaN(iso)) return iso;
    const dmy = v.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})$/);
    if(dmy) return new Date(Number(dmy[3]), Number(dmy[2]) - 1, Number(dmy[1]));
    return null;
  }

  function setImageWithFallback(imgEl, id){
    const slug = sanitizeSlug(id);
    const tries = [IMAGE_PATH + slug + '.png', IMAGE_PATH + slug + '.jpg', DEFAULT_IMAGE];
    let i = 0;
    imgEl.src = tries[i];
    imgEl.onerror = () => { i++; if(i < tries.length) imgEl.src = tries[i]; else imgEl.onerror = null; };
  }

  function overlaps(rangeA, rangeB){
    if(!rangeA || !rangeB) return false;
    const aFrom = rangeA.from ? rangeA.from.getTime() : -Infinity;
    const aTo = rangeA.to ? rangeA.to.getTime() : Infinity;
    const bFrom = rangeB.from ? rangeB.from.getTime() : -Infinity;
    const bTo = rangeB.to ? rangeB.to.getTime() : Infinity;
    return (aFrom <= bTo) && (bFrom <= aTo);
  }

  /* ===== STATE & UI REFS ===== */
  let RAW = [], EVENTS = [], HOSPEDAGENS = [];
  const statusEl = document.getElementById('status');
  const grid = document.getElementById('grid');
  const empty = document.getElementById('empty');
  const hospedGrid = document.getElementById('hospedagemGrid');
  const emptyHosp = document.getElementById('emptyHosp');
  const lastUpdated = document.getElementById('lastUpdated');

  /* ===== TABS ===== */
  document.getElementById('tabEventos').addEventListener('click', () => switchTab('eventos'));
  document.getElementById('tabHospedagem').addEventListener('click', () => switchTab('hospedagem'));
  function switchTab(tab){
    document.querySelectorAll('.tab').forEach(t => t.classList.toggle('active', t.dataset.tab === tab));
    document.getElementById('contentEventos').style.display = tab === 'eventos' ? '' : 'none';
    document.getElementById('contentHospedagem').style.display = tab === 'hospedagem' ? '' : 'none';
  }

  /* ===== SEARCH & FILTER ===== */
  document.getElementById('searchBtn').addEventListener('click', applyFilters);
  document.getElementById('refreshBtn').addEventListener('click', () => loadData(true));

  function applyFilters(){
    const fromVal = document.getElementById('dateFrom').value;
    const toVal = document.getElementById('dateTo').value;
    const praiaOnly = document.getElementById('praiaOnly').checked;
    const userRange = {
      from: fromVal ? new Date(fromVal) : null,
      to: toVal ? new Date(toVal) : null
    };
    const filtered = EVENTS.filter(ev => {
      if(praiaOnly){
        const desc = (ev.Descricao || '').toLowerCase();
        const praiaFlag = (ev.Praia || '').toLowerCase();
        if(!(desc.includes('praia') || praiaFlag === 'x' || praiaFlag === 'sim')) return false;
      }
      if(!userRange.from && !userRange.to) return true;
      const evRange = { from: ev.Inicio || null, to: ev.Fim || null };
      return overlaps(evRange, userRange);
    });
    renderEvents(filtered);
  }

  /* ===== RENDER ===== */
  function renderEvents(list){
    grid.innerHTML = '';
    if(!list || list.length === 0){
      empty.style.display = 'block';
      statusEl.textContent = getI18n('noEvents');
      return;
    }
    empty.style.display = 'none';
    statusEl.textContent = `${list.length} ${getI18n('events')}`;

    list.forEach(ev => {
      const card = document.createElement('article'); card.className = 'card';
      if((ev.Destaque || '').toString().toLowerCase() === 'x') card.classList.add('destaque');

      const media = document.createElement('div'); media.className = 'media';
      const img = document.createElement('img'); img.alt = ev.Nome || 'Evento'; img.loading = 'lazy';
      setImageWithFallback(img, ev.ID);
      media.appendChild(img);
      if((ev.Destaque || '').toString().toLowerCase() === 'x'){
        const b = document.createElement('div'); b.className = 'badge'; b.textContent = 'DESTAQUE'; media.appendChild(b);
      }

      const body = document.createElement('div'); body.className = 'card-body';
      const titleRow = document.createElement('div'); titleRow.className = 'title-row';
      const h3 = document.createElement('h3'); h3.textContent = ev.Nome || 'Evento';
      titleRow.appendChild(h3);

      const desc = document.createElement('div'); desc.className = 'desc'; desc.textContent = ev.Descricao || '';
      const metaRow = document.createElement('div'); metaRow.className = 'meta-row';
      const dates = document.createElement('div');
      const inicio = ev.Inicio ? ev.Inicio.toLocaleDateString() : '—';
      const fim = ev.Fim ? ev.Fim.toLocaleDateString() : '—';
      dates.textContent = `${inicio} → ${fim}`;
      const price = document.createElement('div'); price.textContent = ev.Preco_Hotel ? `R$ ${ev.Preco_Hotel}` : 'Preço sob consulta';
      metaRow.appendChild(dates); metaRow.appendChild(price);

      const actions = document.createElement('div');
      const hotel = document.createElement('a'); hotel.className = 'link primary'; hotel.textContent = getI18n('stays');
      hotel.href = ev.Link_Hotel ? buildAffiliateUrl(ev.Link_Hotel, ev.ID) : '#';
      hotel.target = '_blank'; hotel.rel = 'noopener noreferrer';
      actions.appendChild(hotel);

      body.appendChild(titleRow); body.appendChild(desc); body.appendChild(metaRow); body.appendChild(actions);
      card.appendChild(media); card.appendChild(body);
      grid.appendChild(card);
    });
  }

  function renderHospedagem(list){
    hospedGrid.innerHTML = '';
    if(!list || list.length === 0){
      emptyHosp.style.display = 'block';
      return;
    }
    emptyHosp.style.display = 'none';
    list.forEach(h => {
      const card = document.createElement('article'); card.className = 'card';
      const media = document.createElement('div'); media.className = 'media';
      const img = document.createElement('img'); img.alt = h.Nome || 'Hospedagem'; img.loading = 'lazy';
      setImageWithFallback(img, h.ID || h.Slug || h.Nome);
      media.appendChild(img);
      const body = document.createElement('div'); body.className = 'card-body';
      const titleRow = document.createElement('div'); titleRow.className = 'title-row';
      const h3 = document.createElement('h3'); h3.textContent = h.Nome || 'Hospedagem';
      titleRow.appendChild(h3);
      const desc = document.createElement('div'); desc.className = 'desc'; desc.textContent = h.Descricao || h.Observacoes || '';
      const metaRow = document.createElement('div'); metaRow.className = 'meta-row';
      const price = document.createElement('div'); price.textContent = h.Preco_Hotel ? `R$ ${h.Preco_Hotel}` : 'Preço sob consulta';
      const link = document.createElement('a'); link.className = 'link primary'; link.textContent = 'Reservar';
      link.href = h.Link_Hotel || '#'; link.target = '_blank'; link.rel = 'noopener noreferrer';
      metaRow.appendChild(price); metaRow.appendChild(link);
      body.appendChild(titleRow); body.appendChild(desc); body.appendChild(metaRow);
      card.appendChild(media); card.appendChild(body);
      hospedGrid.appendChild(card);
    });
  }

  function buildAffiliateUrl(url, id){
    if(!url) return '';
    try{
      const u = new URL(url);
      u.searchParams.set('utm_source','bg-site');
      u.searchParams.set('utm_medium','referral');
      u.searchParams.set('utm_campaign', id || 'evento');
      return u.toString();
    }catch(e){
      return url;
    }
  }

  function getI18n(key){
    const lang = localStorage.getItem('bg_lang') || 'pt';
    return (I18N[lang] && I18N[lang][key]) ? I18N[lang][key] : I18N['pt'][key] || '';
  }

  /* ===== LOAD CSV ===== */
  async function loadData(force=false){
    try{
      statusEl.textContent = 'Carregando dados...';
      const url = CSV_URL + (CACHE_BUST || force ? `?t=${Date.now()}` : '');
      const res = await fetch(url, {cache: 'no-cache'});
      if(!res.ok) throw new Error('Falha ao buscar CSV: ' + res.status);
      const text = await res.text();
      if(!text || !text.trim()) throw new Error('CSV vazio');
      const rows = parseCSV(text);
      if(rows.length < 2) throw new Error('CSV sem dados');

      const headers = rows[0].map(h => h.trim());
      const data = rows.slice(1).map(r => {
        const obj = {};
        for(let i=0;i<headers.length;i++) obj[headers[i]] = (r[i] || '').trim();
        return obj;
      });

      RAW = data;

      EVENTS = data.map(row => ({
        ID: row.ID || row.Slug || row.id || '',
        Nome: row.Nome || row.Name || '',
        Inicio: parseDateFlexible(row.Inicio || row.start || ''),
        Fim: parseDateFlexible(row.Fim || row.end || ''),
        Descricao: row.Descricao || row.Description || '',
        Preco_Hotel: row.Preco_Hotel || row.Preco || '',
        Link_Hotel: row.Link_Hotel || row.LinkHotel || '',
        Categoria: row.Categoria || row.Category || '',
        Destaque: row.Destaque || '',
        Praia: row.Praia || row.Local || ''
      }));

      // Hospedagem heurística: linhas com Link_Hotel
      HOSPEDAGENS = EVENTS.filter(e => e.Link_Hotel && e.Link_Hotel.trim() !== '');

      // Remove eventos passados (hands-off)
      const today = new Date(); today.setHours(0,0,0,0);
      EVENTS = EVENTS.filter(ev => {
        if(!ev.Fim && !ev.Inicio) return true;
        if(ev.Fim && ev.Fim < today) return false;
        return true;
      });

      EVENTS.sort((a,b) => (a.Inicio ? a.Inicio.getTime() : 0) - (b.Inicio ? b.Inicio.getTime() : 0));

      const now = new Date();
      lastUpdated.textContent = now.toLocaleString();
      statusEl.textContent = `${EVENTS.length} evento(s) carregado(s)`;

      renderEvents(EVENTS);
      renderHospedagem(HOSPEDAGENS);
    }catch(err){
      console.error(err);
      statusEl.textContent = 'Erro ao carregar dados. Ver console.';
      grid.innerHTML = '';
      hospedGrid.innerHTML = '';
      document.getElementById('empty').style.display = 'block';
      document.getElementById('empty').textContent = 'Erro ao carregar CSV público. Verifique o link e o console.';
    }
  }

  /* ===== INIT ===== */
  // restore theme & lang
  const savedTheme = localStorage.getItem('bg_theme') || (window.matchMedia && window.matchMedia('(prefers-color-scheme:light)').matches ? 'light' : 'dark');
  setTheme(savedTheme);
  const savedLang = localStorage.getItem('bg_lang') || 'pt';
  setLang(savedLang);

  // theme toggle
  document.getElementById('themeToggle').addEventListener('click', () => {
    const next = document.documentElement.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
    setTheme(next);
  });

  // lang toggle
  document.getElementById('langToggle').addEventListener('click', () => {
    const current = localStorage.getItem('bg_lang') || 'pt';
    setLang(current === 'pt' ? 'en' : 'pt');
  });

  // initial load
  loadData();
  setInterval(() => loadData(false), AUTO_REFRESH_MIN * 60 * 1000);
  </script>
</body>
</html>
