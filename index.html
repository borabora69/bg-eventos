<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>BG Eventos & Hospedagem</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root {
  --bg: #0f172a;
  --card: #020617;
  --text: #e5e7eb;
  --accent: #38bdf8;
  --gold: #facc15;
}
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
}
header {
  padding: 20px;
  text-align: center;
}
.filters {
  display: flex;
  gap: 10px;
  justify-content: center;
  flex-wrap: wrap;
}
.filters button {
  padding: 8px 14px;
  border: none;
  background: #1e293b;
  color: white;
  cursor: pointer;
}
.filters button.active {
  background: var(--accent);
  color: black;
}
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill,minmax(280px,1fr));
  gap: 20px;
  padding: 20px;
}
.card {
  background: var(--card);
  border-radius: 12px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}
.card.destaque {
  border: 2px solid var(--gold);
  transform: scale(1.03);
}
.card img {
  width: 100%;
  height: 180px;
  object-fit: cover;
}
.card .content {
  padding: 15px;
  flex: 1;
}
.card h3 {
  margin: 0 0 8px;
}
.card small {
  opacity: 0.7;
}
.card a {
  margin-top: 10px;
  display: inline-block;
  color: var(--accent);
  text-decoration: none;
}
.empty {
  text-align: center;
  opacity: 0.6;
  padding: 40px;
}
</style>
</head>
<body>

<header>
  <h1>Eventos em Barra Grande ‚Äì PI</h1>
  <p>Agenda confirmada + onde se hospedar</p>

  <div class="filters">
    <button class="active" data-cat="Todos">Todos</button>
    <button data-cat="Show">Show</button>
    <button data-cat="Festa">Festa</button>
    <button data-cat="Esporte">Esporte</button>
    <button data-cat="Gastronomia">Gastronomia</button>
  </div>
</header>

<div id="eventos" class="grid"></div>
<div id="empty" class="empty" style="display:none;">
  Nenhum evento encontrado para este filtro.
</div>

<script>
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTYagiDybnUZ6o0nrMPg9OAa5af9fX5pSgc0FW1R3w_A53ueEA-xMyp3SAjpx_rIxJgBGGfic-Q3LDv/pub?output=csv";
let eventosGlobais = [];
let categoriaAtual = "Todos";

fetch(CSV_URL)
  .then(r => r.text())
  .then(text => {
    const linhas = text.split("\n").slice(1);
    const hoje = new Date();

    eventosGlobais = linhas.map(l => {
      const [id, nome, inicio, fim, desc, preco, hotel, ingresso, categoria, destaque] = l.split(",");
      return {
        id, nome, inicio, fim, desc,
        hotel, ingresso,
        categoria: categoria || "Outros",
        destaque: destaque === "Sim",
        dataFim: new Date(fim)
      };
    })
    .filter(e => e.dataFim >= hoje)
    .sort((a,b) => new Date(a.inicio) - new Date(b.inicio));

    render();
  });

function render() {
  const container = document.getElementById("eventos");
  const empty = document.getElementById("empty");
  container.innerHTML = "";

  const filtrados = eventosGlobais.filter(e =>
    categoriaAtual === "Todos" || e.categoria === categoriaAtual
  );

  empty.style.display = filtrados.length ? "none" : "block";

  filtrados.forEach(e => {
    const card = document.createElement("div");
    card.className = "card" + (e.destaque ? " destaque" : "");

    const img = document.createElement("img");
    img.loading = "lazy";
    img.src = `img/eventos/${e.id}.png`;
    img.onerror = () => {
      img.src = `img/eventos/${e.id}.jpg`;
      img.onerror = () => img.src = "img/eventos/padrao-bg.png";
    };

    card.innerHTML = `
      <div class="content">
        <h3>${e.nome}</h3>
        <small>${e.inicio} ‚Üí ${e.fim}</small>
        <p>${e.desc}</p>
        ${e.ingresso ? `<a href="${e.ingresso}?utm_source=bg-eventos" target="_blank">üéü Comprar ingresso</a>` : ""}
        ${e.hotel ? `<a href="${e.hotel}?utm_source=bg-eventos" target="_blank">üè® Ver hospedagem</a>` : ""}
      </div>
    `;
    card.prepend(img);
    container.appendChild(card);
  });
}

document.querySelectorAll(".filters button").forEach(btn => {
  btn.onclick = () => {
    document.querySelectorAll(".filters button").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");
    categoriaAtual = btn.dataset.cat;
    render();
  };
});
</script>

</body>
</html>
