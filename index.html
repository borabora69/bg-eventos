<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BG Eventos & Hospedagem | Barra Grande - PI</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #0367A6; --secondary: #04C2D2; --accent: #F2B705;
            --dark: #0f172a; --card-bg: #1e293b; --text: #F1F5F9;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--dark); color: var(--text); margin: 0; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        
        header { text-align: center; padding: 60px 0 40px; border-bottom: 1px solid rgba(4,194,210,0.1); }
        header h1 { font-size: 2.5rem; margin: 0; color: var(--secondary); }
        header span { color: var(--accent); }

        .events-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 30px; margin-top: 40px; }
        
        .card { background: var(--card-bg); border-radius: 15px; overflow: hidden; transition: 0.3s; border: 1px solid rgba(255,255,255,0.05); display: flex; flex-direction: column; }
        .card:hover { transform: translateY(-8px); border-color: var(--secondary); box-shadow: 0 10px 20px rgba(0,0,0,0.3); }
        
        .img-container { position: relative; width: 100%; height: 200px; background: #000; }
        .card img { width: 100%; height: 100%; object-fit: cover; }
        
        .content { padding: 20px; flex-grow: 1; display: flex; flex-direction: column; }
        .badge { background: var(--accent); color: #000; padding: 3px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: bold; width: fit-content; margin-bottom: 10px; }
        
        .date { color: var(--secondary); font-size: 0.9rem; font-weight: 600; margin-bottom: 10px; }
        .card h3 { margin: 0 0 10px 0; font-size: 1.3rem; }
        .card p { font-size: 0.9rem; color: #94A3B8; margin-bottom: 20px; flex-grow: 1; }

        .btn-group { display: flex; gap: 10px; }
        .btn { flex: 1; padding: 12px; text-align: center; text-decoration: none; border-radius: 8px; font-weight: bold; font-size: 0.85rem; transition: 0.2s; }
        .btn-ticket { background: var(--secondary); color: white; }
        .btn-ticket:hover { background: #03a9b8; }
        .btn-hotel { background: transparent; border: 1px solid var(--secondary); color: var(--secondary); }
        .btn-hotel:hover { background: rgba(4,194,210,0.1); }

        #loader { text-align: center; padding: 50px; font-size: 1.2rem; color: var(--secondary); }
    </style>
</head>
<body>

    <header>
        <div class="container">
            <h1>BG <span>Eventos</span></h1>
            <p>Os melhores eventos e hospedagens em Barra Grande e região</p>
        </div>
    </header>

    <div class="container">
        <div id="loader"><i class="fas fa-spinner fa-spin"></i> Buscando atualizações...</div>
        <div id="events-grid" class="events-grid"></div>
    </div>

    <script>
        // CONFIGURAÇÕES DIRETAS DA SUA PLANILHA
        const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTYagiDybnUZ6o0nrMPg9OAa5af9fX5pSgc0FW1R3w_A53ueEA-xMyp3SAjpx_rIxJgBGGfic-Q3LDv/pub?output=csv';
        const IMG_PATH = 'img/eventos/';
        const DEFAULT_IMG = 'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=800'; // Imagem de praia padrão

        async function init() {
            try {
                const response = await fetch(CSV_URL);
                const data = await response.text();
                
                // Parse CSV simples (considerando que não há vírgulas dentro dos textos)
                const rows = data.split('\n').slice(1); 
                const events = rows.map(row => {
                    const cols = row.split(',');
                    return {
                        id: cols[0]?.trim(),
                        nome: cols[1]?.trim(),
                        inicio: cols[2]?.trim(),
                        fim: cols[3]?.trim(),
                        desc: cols[4]?.trim(),
                        hotel_link: cols[6]?.trim(),
                        ticket_link: cols[7]?.trim()
                    };
                }).filter(ev => ev.id); // Remove linhas vazias

                render(events);
            } catch (err) {
                document.getElementById('loader').innerHTML = "Erro ao carregar eventos. Verifique a conexão.";
                console.error(err);
            }
        }

        function render(events) {
            const grid = document.getElementById('events-grid');
            const loader = document.getElementById('loader');
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            // Filtro automático: remove eventos que já passaram do dia de término
            const activeEvents = events.filter(ev => {
                const dateParts = ev.fim.split('/'); // Assume formato DD/MM/AAAA ou AAAA-MM-DD
                const endDate = new Date(ev.fim); 
                return endDate >= today;
            });

            loader.style.display = 'none';

            if (activeEvents.length === 0) {
                grid.innerHTML = "<p style='text-align:center; grid-column: 1/-1;'>Nenhum evento programado para hoje.</p>";
                return;
            }

            grid.innerHTML = activeEvents.map(ev => `
                <div class="card">
                    <div class="img-container">
                        <img src="${IMG_PATH}${ev.id}.png" 
                             onerror="this.onerror=null; this.src='${IMG_PATH}${ev.id}.jpg'; this.setAttribute('onerror', 'this.src=\'${DEFAULT_IMG}\'')">
                    </div>
                    <div class="content">
                        <div class="badge">Destaque</div>
                        <span class="date"><i class="far fa-calendar-alt"></i> ${ev.inicio}</span>
                        <h3>${ev.nome}</h3>
                        <p>${ev.desc || 'Confira os detalhes deste evento em Barra Grande.'}</p>
                        <div class="btn-group">
                            <a href="${ev.ticket_link}" class="btn btn-ticket" target="_blank">Ingressos</a>
                            <a href="${ev.hotel_link}" class="btn btn-hotel" target="_blank">Hospedagem</a>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        init();
    </script>
</body>
</html>
