<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>BG Eventos & Hospedagem</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
  --bg:#0f172a; --card:#020617; --text:#e5e7eb;
  --accent:#38bdf8; --gold:#facc15;
}
body {
  margin:0; font-family:Arial,sans-serif;
  background:var(--bg); color:var(--text);
}
header { padding:20px; text-align:center; }
form {
  display:grid; gap:10px;
  grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
  max-width:900px; margin:20px auto;
}
input,select,button {
  padding:10px; border-radius:6px; border:none;
}
button {
  background:var(--accent); cursor:pointer;
}
.filters {
  display:flex; gap:10px; justify-content:center;
  flex-wrap:wrap; margin:20px;
}
.filters button {
  background:#1e293b; color:white;
}
.filters button.active {
  background:var(--accent); color:black;
}
.grid {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(300px,1fr));
  gap:20px; padding:20px;
}
.card {
  background:var(--card); border-radius:12px;
  overflow:hidden; display:flex; flex-direction:column;
}
.card.destaque {
  border:2px solid var(--gold);
  transform:scale(1.02);
}
.card img {
  width:100%; height:180px; object-fit:cover;
}
.content { padding:15px; }
a { color:var(--accent); text-decoration:none; }
.empty { text-align:center; opacity:.6; padding:40px; }
</style>
</head>

<body>

<header>
<h1>Eventos e Hospedagem em Barra Grande ‚Äì PI</h1>
<p>Veja o que acontece no per√≠odo da sua viagem</p>

<form id="busca">
  <input type="date" id="entrada" required>
  <input type="date" id="saida" required>
  <select id="adultos">
    <option value="1">1 Adulto</option>
    <option value="2" selected>2 Adultos</option>
    <option value="3">3 Adultos</option>
    <option value="4">4 Adultos</option>
  </select>
  <select id="criancas">
    <option value="0" selected>0 Crian√ßas</option>
    <option value="1">1 Crian√ßa</option>
    <option value="2">2 Crian√ßas</option>
  </select>
  <button type="submit">Buscar</button>
</form>

<div class="filters">
  <button class="active" data-cat="Todos">Todos</button>
  <button data-cat="Show">Show</button>
  <button data-cat="Festa">Festa</button>
  <button data-cat="Esporte">Esporte</button>
  <button data-cat="Gastronomia">Gastronomia</button>
</div>
</header>

<div id="resultados" class="grid"></div>
<div id="empty" class="empty" style="display:none;">
Nenhum evento encontrado nesse per√≠odo.
</div>

<script>
const CSV =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vTYagiDybnUZ6o0nrMPg9OAa5af9fX5pSgc0FW1R3w_A53ueEA-xMyp3SAjpx_rIxJgBGGfic-Q3LDv/pub?output=csv";

let eventos=[], categoria="Todos";

fetch(CSV).then(r=>r.text()).then(text=>{
  const linhas=text.split("\n").slice(1);
  eventos=linhas.map(l=>{
    const [id,nome,inicio,fim,desc,preco,hotel,ingresso,cat,dest] = l.split(",");
    return {
      id,nome,desc,hotel,ingresso,
      inicio:new Date(inicio),
      fim:new Date(fim),
      categoria:cat||"Outros",
      destaque:dest==="Sim"
    };
  });
});

document.getElementById("busca").onsubmit=e=>{
  e.preventDefault();
  render();
};

function render(){
  const ent=new Date(entrada.value);
  const sai=new Date(saida.value);
  const adultos=document.getElementById("adultos").value;
  const criancas=document.getElementById("criancas").value;
  const box=document.getElementById("resultados");
  box.innerHTML="";

  const filtrados=eventos.filter(e=>{
    const dentro = e.inicio <= sai && e.fim >= ent;
    const catOk = categoria==="Todos" || e.categoria===categoria;
    return dentro && catOk;
  });

  document.getElementById("empty").style.display =
    filtrados.length ? "none":"block";

  filtrados.forEach(e=>{
    const c=document.createElement("div");
    c.className="card"+(e.destaque?" destaque":"");

    const img=document.createElement("img");
    img.loading="lazy";
    img.src=`img/eventos/${e.id}.png`;
    img.onerror=()=>{img.src=`img/eventos/${e.id}.jpg`;
      img.onerror=()=>img.src="img/eventos/padrao-bg.png";};

    c.appendChild(img);
    c.innerHTML+=`
      <div class="content">
        <h3>${e.nome}</h3>
        <small>${e.inicio.toLocaleDateString()} ‚Üí ${e.fim.toLocaleDateString()}</small>
        <p>${e.desc}</p>
        ${e.ingresso?`<a target="_blank"
          href="${e.ingresso}?utm_source=bg-eventos&utm_adultos=${adultos}&utm_criancas=${criancas}">
          üéü Ingresso</a><br>`:""}
        ${e.hotel?`<a target="_blank"
          href="${e.hotel}?utm_source=bg-eventos&utm_adultos=${adultos}&utm_criancas=${criancas}">
          üè® Onde ficar</a>`:""}
      </div>`;
    box.appendChild(c);
  });
}

document.querySelectorAll(".filters button").forEach(b=>{
  b.onclick=()=>{
    document.querySelectorAll(".filters button")
      .forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
    categoria=b.dataset.cat;
    render();
  };
});
</script>

</body>
</html>
